<!DOCTYPE html>
<html>
<head>
    <title>教师布置作业</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta name="x5-orientation"content="landscape">
    <meta name="screen-orientation"content="landscape">
    <link rel="stylesheet" type="text/css" href="../../css/shijian.css">
    <link rel="stylesheet" type="text/css" href="../../css/common.css">
    <style type="text/css">
            
            .decorate{
                color: #008000;
                background-color: #fff;
                height: 24px;
                line-height: 24px;
                width: 110px;
                text-align: center;
                font-size: 16px;
                font-weight: 600;
                margin-bottom: 4px;
                margin-left: 4px;
            }   

                        /*时间选择*/
            .box{
                text-align: center;
            }

            .jsbox{
                max-width: 500px;
                text-align: left;
                margin: 0 auto;
            }
            #selectTime{
                background-color: rgba(136,200,155,1);
                border: 0px;
                text-align: center;
                color: #fff;
                width: 100%;
                line-height: 30px;
                height: 30px;
                margin-top: 4px;
            }
           .mainleft{
            height: 70%
           }
           .che .input_che:checked+span:after{
            top: -8px;
           }
           .cell1{
            width: 6%;
           }
           .cell2{
            width: 6%;
           }
           .cell3{
            width: 24%;
           }
           .cell4{
            width: 12%;
           }
           .cell5{
            width: 8%;
           }
           .cell6{
            width: 8%;
           }
           .cell7{
            width: 6%;
           }
           .cell8{
            width: 10%;
           }
           .cell10{
            width: 6%;
           }
           .cell11{
            width: 6%;
           }

           .cell12{
            width: 8%;
           }
        
           .serial{
            display: inline-block;
        }
        .che{
            margin-left: 12px;
        }
        .trline{
            height: 40px;
            margin-top: 3px;
            box-sizing: border-box;
             line-height: 45px;
        }
           
        .lists li:after{
            content: "";
            display: block;
            clear: both;
        }
        .chosec2{
            margin-bottom: 10px;
        }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button{                -webkit-appearance: none !important;           
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav">
            <div class="logos lf">
                <img src="../../img/120.gif">
                <span>启思教育</span>
            </div>
            <div class="homes" onclick="C.rotateImg()">
                <img class="" src="../../img/home.png">
            </div>
            <div class="con_title">英语阅读宝</div>
            <div class="operation rf">
                <div class="ope_first lf">
                    <img src="../../img/120.png">
                    <span>张三</span>
                    <ul class="message_list">
                        <li>
                            <a href="#">基本资料</a>
                        </li>
                        <li>
                            <a href="#">安全设置</a>
                        </li>
                        <li>
                            <a href="#">消息中心</a>
                        </li>
                    </ul>
                </div>
                <div class="exit lf">
                    <a href="../../index.html">退出</a>
                </div>
            </div>
            <div class="leafbg">
                <img src="../../img/homework/u1884.gif">
            </div>
        </div>
        <div class="mainContent">
            <div class="cenContent">
                <div class="main">
                    <div class="mainleft">
                        <ul class="nav_list">
                            <li class="navactive"><a href="homework.html">布置作业</a> </li>
                            <li>
                                <a href="personal.html">个人作业</a>            
                            </li>
                            <li><a href="result.html">成绩统计</a></li>
                            <li><a href="read.html">阅卷</a></li>
                            <li><a href="were.html">错题库</a></li>
                            <li><a href="assessment.html">评估</a></li>
                            <li><a href="management.html">班级管理</a></li>
                            <li><a href="../buy/buy.html">更多篇章</a></li>
                        </ul>
                    </div>
                    <div class="maincenter">
                        
                        <div class="cen_content">
                            <div class="task_list">查看已布置任务</div>
                            <div class="decorate">布置班级作业</div>
            
                            <ul class="tablelist">
                              
                            </ul>
                            <div class="skip">
                                <input type="number" name="skip" min="0">
                                <p class="allcount">共<span></span>页</p>
                                <div class="skipBtn">跳转</div>
                            </div>
                             <!-- 页码 -->
                             <div class="count">1</div>
                             <!-- 发布任务 -->
                             <div class="release">
                                发布任务
                             </div>
                            <!-- 左右翻页 -->
                            <div class="left_btn">
                                上一页
                            </div>
                            <div class="right_btn">
                                下一页
                            </div>
                        </div>

                    </div>
                    <div class="mainright">
                        <div class="seleclasses">
                            <p>选择班级</p>
                                <input type="text" class="selectNum" value="未选择">
                        </div>
                        <div class="choose">
                            
                            <div class="chosec  cholast">
                                <p>选择学期</p>
                                <p class="selSemester">未选择</p>
                            </div>
                            <div class="chosec  chosec2">
                                <p>选择单元</p>
                                <P class="selUnit">未选择</P>
                            </div>
                            <div class="chosec chosec1" >
                                <p id="times-1">选择布置日期</p>
                                <div class="box">
                                    <input type="text"  id="selectTime" placeholder="未选择" />
                                    
                                </div>
                            </div>
                            <div class="chosec">
                                <div class=" chofir">
                                    <p>限时</p>
                                    <p class="chofirTime">未选择</p>
                                </div>
                                
                            </div>
                            <div class="tarskName">
                                <p>任务名称</p>
                                <input type="text" name="tarskName" value="未选择">
                            </div>
                        </div>
                   
                    
                </div>
            </div>
            <div class="bg-line">
               
            </div>    
        </div>
        </div>
    </div>
    <div class="mask">
       <div class="maskflex">
            <div class="lists">
                <span class="close_list">×</span>
                <div class="listTimes">
                    <label>时间：</label>
                    <input type="number" name="time" maxlength="3">

                    <p>*时间单位：分钟</p>
                </div>
                <div class="tarskSetName">
                    <label>名称：</label>
                    <input type="text" name="tarskname">
                </div>
                <ul class="classSec"></ul>
                <ul class="semester"></ul>
                <ul class="unit"></ul>
                <p class="mask_sure">确定</p>
            </div>
       </div>
    </div>
    <div id="pop-box"></div>
    <div class="layerMask"></div>
    <div class="loading">
        <div class="loadBox">
            <div class="spinner"></div>
            <p>加载中，请稍后。。。</p>
        </div>
    </div>
    <div class="notice_mask">
        <div class="notice_list">
            <div class="notice_close"><img src="../../img/error.png"></div>
            <ul class="tab_list">
                <li><img src="../../img/u6753.png"></li>
                <li><img src="../../img/u6755.png"></li>
                <li><img src="../../img/u6757.png"></li>
            </ul>
            <ul class="nav_content">
                <li class="Modify">
                    <div class="Modify_header">
                        <div class="Modify_headLeft">
                            <img src="../../img/u6757.png">
                            <p>修改头像</p>
                        </div>
                        <div class="Modify_headRight">
                            <p class="Modify_title">基本资料设置</p>
                            <p style="text-align: left;">张三</p>
                            <p style="text-align: left;">13777838419</p>
                            <div class="signs">签到</div>
                        </div>
                        
                    </div>
                    <form class="Modify_content">
                        <div class="Modify_line">
                            <label>姓名</label>
                            <input type="text" name="stuname" placeholder="请输入您的姓名">
                        </div>
                        <div class="Modify_line">
                            <label>性别</label>
                            <input type="text" name="stuname" placeholder="请输入您的性别">
                        </div>
                        <div class="Modify_line">
                            <label>年龄</label>
                            <input type="text" name="stuname" placeholder="请输入您的年龄">
                        </div>
                        <div class="Modify_line">
                            <label>学校</label>
                            <input type="text" name="stuname" placeholder="请输入您的学校">
                            <p>学校信息无法修改</p>
                        </div>
                        <div class="Modify_submit">
                            
                            <input type="button" value="修改">
                           
                        </div>
                    </form>
                </li>
                <li></li>
                <li></li>
            </ul>
        </div>
    </div>
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/laydate.js"></script>
    <script type="text/javascript" src="../../js/request.js"></script>
    <script type="text/javascript" src="../../js/subject.js"></script>
    <script type="text/javascript" src="../../js/common.js"></script>
    <script type="text/javascript">
        $(function () { 
            var tarsks={
                'type':'0'
            };
           var paramClass={
                "IndexPage": 1,
                "IndexSize":100
            }
            var sessionGradeid=sessionStorage.getItem('gradeid');
            var Terms = sessionStorage.getItem('Term');
            var gradeNames = sessionStorage.getItem('gradeName');
            var TermNumber=sessionStorage.getItem('TermNumber');
            var unitsNum=sessionStorage.getItem("units");
            var gradeShowName=sessionStorage.getItem('gradeShowName');
            var classListId=[],gradeid='',gradeName='';//班级id列表
            // tarsks.questionList=[];
            tarsks.publisherId=localStorage.getItem('publisherId');
            tarsks.publisherName = localStorage.getItem('publisherName');
            var accountName=sessionStorage.getItem('accountName');
            paramClass.TeacherId=accountName;
            getIdentity();
            //页面自适应
            
            $(window).resize(function () { 
                C.resezes();
            });
            C.resezes(1);
            //获取老师信息
            function getIdentity(){
                C.load(0);
                var getTeacherInfor=C.POST(null,httpUrl.GetTeacherInfo,successGetIdenty);
                
            }
            function successGetIdenty(getTeacherInfor){
                if(getTeacherInfor.Result==1){
                    // 获取班级列表
                    localStorage.setItem('teacherNames',getTeacherInfor.Data.Name);
                    $(".ope_first").find('span').text(getTeacherInfor.Data.Name);
                    // paramClass.TeacherId=getTeacherInfor.Data.Id;
                    //获取班级数据
                    getClassData();
                    teacherImfor=getTeacherInfor.Data;
                    sessionStorage.setItem("TeacherId",getTeacherInfor.Data.Id);
                    localStorage.setItem("TeacherIds",getTeacherInfor.Data.Id);//学生设计
                    localStorage.setItem("schoolId",getTeacherInfor.Data.SchoolId);
                    tarsks.schoolId  = getTeacherInfor.Data.SchoolId; 
                    C.load(1);
                }else{
                    C.load(1);
                    C.layer(1,getTeacherInfor.Message);
                }
            }
            var classCount=1;
            function getClassData(){
                var classData=C.POSTS(JSON.stringify(paramClass),httpUrl.GetClassListByTeacherID,successGetclass);
            }
            var classnum=0;
            function successGetclass(classData){
                if(classData.Result==1){
                    createClassList(classData.Data);
                }else{
                     paramClass.IndexPage-=classnum;
                    C.layer(1,classData.Message);
                }
            }
            if(sessionStorage.getItem('classChecked')){
                classListId=sessionStorage.getItem('classChecked').split(',');
            }
            
            
            function createClassList(data){
                var list='';
                
                for(var i=0;i<data.length;i++){
                  if(data[i].IsAfterSchool){
                        xiaowai="(校外)";
                    }else{
                        xiaowai="";
                    }
                    var fool=false;
                    if(classListId.length!=0){
                        for(var j=0;j<classListId.length;j++){
                            if(data[i].Id == classListId[j]){
                                fool=true;
                            }
                        }
                        if(fool == true){
                            list+='<li><input type="checkbox" id='+data[i].Id+' name="seleclasses" gradeid='+data[i].GradeId+' checked><span>'+data[i].Name+xiaowai+'</span></li>';
                        }else{
                             list+='<li><input type="checkbox" id='+data[i].Id+' name="seleclasses" gradeid='+data[i].GradeId+'><span>'+data[i].Name+xiaowai+'</span></li>';
                        }
                    }else{
                        list+='<li><input type="checkbox" id='+data[i].Id+' name="seleclasses" gradeid='+data[i].GradeId+'><span>'+data[i].Name+xiaowai+'</span></li>'
                    }
                    
                }
                //判断是否第一次操作，是否有数据
                if(sessionGradeid){
                    Semester(sessionGradeid);
                    if(gradeShowName){
                        $(".selSemester").text(gradeShowName);
                    }

                    if(unitsNum){
                        $('.selUnit').text(unitsNum);
                        param.Unit=unitsNum;
                    }
                    param.Grade=gradeNames;
                    getunitData(gradeNames,Terms)
                }
                $('.selectNum').val('您选择了'+classListId.length+'个班级');
                $(".classSec").html(list);
            }
            var gradeid=0;
            
            $('.classSec').on('click','input',function(){
                classListId=[];
                var checkBool=$(this).get(0).checked;
                if(checkBool){
                    if(gradeid==0){
                        gradeid=$(this).attr('gradeid');
                        sessionStorage.setItem('gradeid',gradeid);
                        Semester(gradeid);

                    }else{
                        if(gradeid!=$(this).attr('gradeid')){
                            C.layer(2,'不能选择不同年级的班级！');
                            $(this).attr("checked", false);
                        }
                    }
                }else{
                    gradeid=0;
                }
                
                $('.classSec input[name="seleclasses"]:checked').each(function(){
                    var spanid=$(this).attr('id');
                    if(classListId.indexOf(spanid)==-1){
                        classListId.push(spanid);
                    }
                });
                
                sessionStorage.setItem('classChecked',classListId);
            });
            $('.mask_sure').on('click',function(){
                var bools=$('.classSec').css('display');
                var len=classListId.length;
                if(bools=='block' || bools=='inline'){
                    
                    $('.selectNum').val('您选择了'+len+'个班级');
                }
            });
            $('body').on('click','#xxclTitle,#jxgyTitle,#bjzsTitle,#jxjyTitle,#swjcTitle,#yfzjTitle，#zyTitle,#yfzjTitle,#zyTitle',function(){
                C.toggleImg(this);
            });
         
            //发送任务

            $(".release").on("click",function () {
                var times= $("#selectTime").val();
                if(times==''){
                    var myDate = new Date();
                    var dateArr=myDate.toLocaleDateString().split('/');
                    tarsks.doQuestions=dateArr[0]+'-'+dateArr[1]+'-'+dateArr[2];
                    
                }else{
                    tarsks.doQuestions=times;
                }
                tarsks.classIdList   = classListId;
                tarsks.gradeId = gradeid;
                tarsks.courseId = '0';
                tarsks.questionList =questionList;
                if(tarsks.questionList.length!=0){
                    var data=C.POSTS(JSON.stringify(tarsks),httpUrl.SendClassTask,successSend);
                }else{
                    C.layer(2,"请选择篇章！");
                }
            });
            function successSend(data){
                if(data.Result==1){
                    C.comfig("发送成功！",'check');
                }else{
                    C.layer(1,data.Message);
                }
            }
            //学期列表
            function Semester(id){
                var htmls='';
                switch(id)
                {
                case '7':
                    htmls='<li><input type="radio" name="semester" dataName="七年级上" value="七年级" data-id="0">七年级上</li>';
                    htmls+='<li><input type="radio" name="semester" dataName="七年级下" value="七年级" data-id="1">七年级下</li>';
                    break;
                case '8':
                    htmls='<li><input type="radio" name="semester" dataName="八年级上" value="八年级" data-id="0">八年级上</li>';
                    htmls+='<li><input type="radio" name="semester" dataName="八年级下" value="八年级" data-id="1">八年级下</li>';
                    break;
                case '9':
                    htmls='<li><input type="radio" name="semester" dataName="九年级上" value="九年级" data-id="0">九年级上</li>';
                    htmls+='<li><input type="radio" name="semester" dataName="九年级下" value="九年级" data-id="1">九年级下</li>';
                    break;
                case '10':
                    htmls='<li><input type="radio" name="semester" dataName="高一上" value="高一" data-id="0">高一上</li>';
                    htmls+='<li><input type="radio" name="semester" dataName="高一下" value="高一" data-id="1">高一下</li>';
                    break;
                case '11':
                    htmls='<li><input type="radio" name="semester" dataName="高二上" value="高二" data-id="0">高二上</li>';
                    htmls+='<li><input type="radio" name="semester" dataName="高二下" value="高二" data-id="1">高二下</li>';
                    break;
                case '12':
                    htmls='<li><input type="radio" name="semester" dataName="高三上" value="高三" data-id="0">高三上</li>';
                    htmls+='<li><input type="radio" name="semester" dataName="高三下" value="高三" data-id="1">高三下</li>';
                    break;
                default:
                    htmls='没有这个年级';
                    break;
                }
                $(".semester").empty();
                $(".semester").html(htmls);
                if(TermNumber){
                    $('.semester').find('li').eq(TermNumber).find('input').attr('checked',true);
                }
                
            }
            var checkedIds= [];//保存选中的id，亦适用于分页
            var questionList =[];//保存篇章列表信息
            //点击input选中篇章列表
            $(".tablelist").on("click",'input',function(){
                if(classListId.length!=0 && $('.selSemester').text()!='未选择'){
                    if($(this).is(":checked")){
                        if(questionList.length>=5){
                            C.layer(2,"最多选择5条信息！");
                            return false;
                        }else{
                            checkedIds.push($(this).attr("id"));
                            var quesLen=checkedIds.length-1;
                            questionList.push({});
                            questionList[quesLen].id = $(this).attr("id");
                            questionList[quesLen].score  = $(this).parents('.trline').find('.cell11').text();
                            questionList[quesLen].writingSkillId  = $(this).parents('.trline').find('.cell9').text();
                            questionList[quesLen].Term=terms;
                            questionList[quesLen].Unit=units;
                        }
                     }else{
                         for(var i=0; i<checkedIds.length; i++){
                             if($(this).attr("id") == checkedIds[i]){
                             checkedIds.splice(i, 1);
                             questionList.splice(i,1);
                             break;
                             }
                         }
                     }
                }else{
                     C.layer(2,"请先选择班级和学期");
                    return false;
                }
            });
            //翻页后设置是否选中
            function setChecked(){
                
               var $boxes = $(".tablelist input");
               for(var i=0;i<$boxes.length;i++){
                   var id = $boxes[i].id;
                   if(checkedIds.indexOf(id,0)!=-1){
                       $boxes[i].checked = true;
                       
                   }else{
                       $boxes[i].checked = false;
                   }
               }
               var arr=$('input[type=checkbox]:checked');
            }
            var param={
                "IndexPage":1,
                "IndexSize":10
            };
            var Vparams={
                'IndexPage':1,
                'IndexSize':1
            };
            if(gradeNames && Terms && unitsNum){
                param.Grade=gradeNames;
                param.Term=Terms;
                param.Unit=unitsNum;
            }
            var count=1;
            $(".ope_first").on({
                mouseover:function (e) {
                    e.stopPropagation();
                    $(".message_list").show();
                },
                mouseout:function (e) {
                    e.stopPropagation();
                    $(".message_list").hide();
                }
            });
            // 左翻页
            var tablenum=0;
            $(".left_btn").on("click",function(){
                var nums=parseInt($('.count').text());
                if(param.IndexPage!=parseInt(nums)){
                    param.IndexPage=parseInt(nums);
                }
                C.leftPage(param,tablenum,getdata,this);
          
            });
            $(".right_btn").on("click",function(){
                var nums=$('.count').text();
                if(param.IndexPage!=parseInt(nums)){
                    param.IndexPage=parseInt(nums);
                }
                C.rightPage(param,tablenum,count,getdata,this);
                
            });
            //跳转页面
            $('.skipBtn').on('click',function () {
                var num=$('.skip').find('input').val();
                // if(){}
                param.IndexPage=num;
                getdata();
            });
            //获取篇章列表数据
            function getdata(){
             
                var tableData=C.POSTS(JSON.stringify(param),httpUrl.GetArticleList,successGetData);
                
            }
            function successGetData(tableData){
                if(tableData.Result==1){
                    if(tableData.Count%param.IndexSize>0){
                        count=parseInt(tableData.Count/param.IndexSize)+1;
                    }else{
                        count=parseInt(tableData.Count/param.IndexSize);
                    }
                    $('.allcount').find('span').text(count);
                    $(".count").text(param.IndexPage);
                    createList(tableData.Data);
                    setChecked();
                }else{
                     param.IndexPage-=tablenum;
                     C.layer(1,tableData.Message);

                }
            }
            function createList(data){
                var list='<li><p class="cell1">编号</p><p class="cell2">选中</p><p class="cell3">篇章名称</p><p class="cell4">话题</p><p class="cell5">题型</p><p class="cell6">文体</p><p class="cell7">难度</p><p class="cell8">精读/泛读</p><p class="cell10">词数</p><p class="cell11">分数</p><p class="cell12">操作</p></li>';
                for(var i=0;i<data.length;i++){
                    var index=1;
                  
                    index=(param.IndexPage-1)*param.IndexSize+i+1;
                    
                    if(i<data.length-1){
                        list+='<li class="trline"  style="border-bottom:1px solid #999">';
                       
                    }else{
                        list+='<li class="trline">';
                        
                    }
                    
                    list+='<p class="cell1"> <span class="serial">'+index+'</span> </p>';
                    list+='<p class="cell2"><label class="che"><input id='+data[i].Id+' type="checkbox" class="input_che" ><span></span></label></p>';
                    list+='<p class="chapter cell3" style="text-align:left" title="'+data[i].Name+'"">'+data[i].Name+'</p>';
                    list+='<p class="cell4" title="'+data[i].Topic+'">'+data[i].Topic+'</p>';
                    list+='<p class="cell5" title="'+data[i].QuestionsType+'">'+data[i].QuestionsType+'</p>';
                    list+='<p class="cell6">'+data[i].LiteraryForm+'</p>';
                    list+='<p class="cell7">'+data[i].Difficulty+'</p>';
                    if(data[i].JiaoCanId){
                        list+='<p class="cell8">精读</p>';
                    }else{
                        list+='<p class="cell8">泛读</p>';
                    }
                    
                    list+='<p class="cell10">'+data[i].Words+'</p>';
                    list+='<p class="cell11">'+data[i].Score+'</p>';
                    if(data[i].JiaoCanId){
                        list+='<p class="cell12"><span class="view dbtn" data-id="' + data[i].Id + '" >教参预览</span></p>';
                    }else{
                        list+='<p class="cell12"><span class="view dbtn" data-id="' + data[i].Id + '" >预览</span></p>';
                    }
                 
                    
                    list+='</li>';
                }
                $(".tablelist").html(list);
            }
            // 时间弹出层
            $(".mask_sure,.close_list").on("click",function(){
                var tarskBool=$('.tarskSetName').css('display');
                var v=$('.tarskSetName').find('input').val();
                if(tarskBool == 'inline' || tarskBool == "block"){
                    if(v.length >0){
                        $(".tarskName").find('input').val(v);
                        tarsks.Name=v;
                    }
                    
                }
                $('.mask').hide();
                $('.mask').find("ul").hide();
                $('.listTimes').hide();
                $('.tarskSetName').hide();


            });
          
            laydate.render({
                elem: '#selectTime' //指定元素
                ,eventElem: '#times-1'
                ,min:0
                ,format: 'yyyy-MM-dd'
            });
            //完成时间选择
            $(".listTimes,.semester,.unit,.classSec,.tarskSetName").on("click",function(e){

                e.stopPropagation();
            });
         
            $(".listTimes input").on("change",function(){
                var v=$(this).val();
                $(".chofirTime").text(v);
                tarsks.limitedTime=parseInt(v);
            });
            $(".chofir").on("click",function(){
                $(".mask").show();
                $(".listTimes").show();
            });
            //任务名称
            $('.tarskName').on('click',function () {
                $(".mask").show();
                $(".tarskSetName").show();
            });
            //班级选择
            $('.seleclasses').on('click',function(){
                $(".mask").show();
                $(".classSec").show();
            });
            //学期选择
            $(".cholast").on("click",function(){
                
                if(classListId.length!=0){
                    $(".mask").show();
                    $(".semester").show();

                }else{
                    C.layer(2,"请先选择班级!");
                    return false;
                }
            });
            var terms='';

            $(".semester").on("click",'input',function(){
                param.IndexPage=1;
                $('.count').text(param.IndexPage);
                gradeName=$(this).val();
                // sessionStorage.setItem('selSemester',gradeName);
                var v=$(this).attr('dataName');
                $(".selSemester").text(v);
                param.Grade=gradeName;
                terms=$(this).val();
                var Term = $(this).attr('data-id');
                if(Term=='0'){
                    param.Term="上学期";
                }else if(Term=='1'){
                    param.Term="下学期";
                }
                sessionStorage.setItem('TermNumber',Term);
                sessionStorage.setItem('Term',param.Term);
                sessionStorage.setItem('gradeName',param.Grade);
                sessionStorage.setItem('gradeShowName',v);
                getunitData(param.Grade,param.Term)
                getdata();
            });
            //年级选择

            $(".chosec2").on("click",function(){
                if($('.selSemester').text()!='未选择'){
                    $(".unit").show();
                    $(".mask").show();
                }else{
                    C.layer(2,"请先选择学期！");

                }
            });
             var units='';
            $(".unit").on("click",'input',function(){
                param.IndexPage=1;
                $('.count').text(param.IndexPage);
                var v=$(this).val();
                units=v;
                sessionStorage.setItem("units",v);
                $(".selUnit").text(v);
                param.Unit=v;
                getdata();
            });
            //单元选择

            function getunitData(Grade,Term){
                var unitdata={
                    'Grade':Grade,
                    'Term':Term,
                    'IndexPage':1,
                    'IndexSize':20
                } 
                var unitDatas=C.POST(unitdata,httpUrl.GetUnitList,unitlist);
                
            }
            function unitlist(unitDatas){
                if(unitDatas.Result==0){
                    var data=unitDatas.Data;
                    var htmls='';
                    for(var i=0;i<data.length;i++){
                        if(unitsNum == i+1){
                            htmls+='<li><input type="radio" name="unit" value='+data[i].Unit+' checked>单元'+data[i].Unit+'</li>';
                        }else{
                            htmls+='<li><input type="radio" name="unit" value='+data[i].Unit+' >单元'+data[i].Unit+'</li>';
                        }
                       
                    }
                    $('.unit').html(htmls);
                }else{
                    C.layer(1,unitDatas.Message);
                }
            }
            // 预览
            $(".tablelist").on("click",".view",function(){

                Vparams.Id=$(this).attr('data-id');
                ajaxView();
            });
            function ajaxView(){
                 var ajaxViewData=C.POSTS(JSON.stringify(Vparams),httpUrl.GetEnglishArticleWithQuestion,successAjax);
                 
            }
            function successAjax(ajaxViewData){
                if(ajaxViewData.Result==1){
                    PreviewSubject(ajaxViewData.Data);
                }else{
                    C.layer(1,ajaxViewData.Message);
                }
            } 
            $(".close").on("click",function(){
                $(".premask").hide();
            });
            $(".task_list").on('click',function(){
                window.location.href="decorate.html";
            });
             //题目预览
            function PreviewSubject(data) {
                var options = {};
     
                if(data.JiaoCanId){
                    var str = TeacherSubjectString(data);
                }else{
                    var str = TeacherSubjectStrings(data);
                }
                
            
                openPopWin('checkDetail', str);
            }
            //弹出层预览
             function openPopWin(type, content) { //根据传递进来的值，更改str内容

                var pop = document.querySelector("#pop-box");
                var str = "";
                // if (type == "checkDetail") {
                    str = '<div class="pop-win pop-content">\
                        <header class="close-btn-box"></header>\
                        <div class="pop-scroll">\
                            <div class="pop-content">';
                    str += content;
                    str += '</div>\
                        </div>\
                    </div>';
                pop.innerHTML = str;

                var box = document.querySelector(".close-btn-box");
                var btn = document.createElement("span");
                var _this = this;
                btn.className = "close-btn";
                btn.addEventListener("click", function () {
                    $(pop).find(".pop-content").hide("slow", function () {
                        pop.innerHTML = "";
                    });
                });
                box.appendChild(btn);
            }
           
           
            getdata();
        });
    </script>
</body>
</html>